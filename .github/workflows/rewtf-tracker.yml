name: REWTF Activity Tracker

on:
  push:
    branches: [ main, develop, master ]
  pull_request:
    branches: [ main, master ]
  schedule:
    # Her gÃ¼n saat 12:00'da Ã§alÄ±ÅŸ (UTC)
    - cron: '0 12 * * *'

jobs:
  track-activity:
    runs-on: ubuntu-latest
    
    steps:
    - name: Checkout code
      uses: actions/checkout@v4
      
    - name: Setup Node.js
      uses: actions/setup-node@v4
      with:
        node-version: '18'
        
    - name: Check if Node.js project
      id: check-node
      run: |
        if [ -f "package.json" ]; then
          echo "has-package-json=true" >> $GITHUB_OUTPUT
        else
          echo "has-package-json=false" >> $GITHUB_OUTPUT
        fi
        
    - name: Install dependencies
      if: steps.check-node.outputs.has-package-json == 'true'
      run: npm install
      
    - name: Run linting (if available)
      if: steps.check-node.outputs.has-package-json == 'true'
      run: |
        if npm run lint 2>/dev/null; then
          echo "âœ… Linting passed"
        else
          echo "âš ï¸ Linting not configured, skipping"
        fi
      continue-on-error: true
      
    - name: Build project (if available)
      if: steps.check-node.outputs.has-package-json == 'true'
      run: |
        if npm run build 2>/dev/null; then
          echo "âœ… Build successful"
        else
          echo "âš ï¸ Build script not available, skipping"
        fi
      continue-on-error: true
      
    - name: REWTF Activity Log
      run: |
        echo "ğŸ† REWTF Activity Logged!"
        echo "ğŸ“Š Commit: ${{ github.sha }}"
        echo "ğŸ‘¤ Author: ${{ github.actor }}"
        echo "ğŸ“… Date: $(date)"
        echo "ğŸŒŠ Flow Project: Fortefication - Automated DeFi Portfolio Manager"
        echo "ğŸ¯ Features: Portfolio Management, Risk Analysis, Automated Rebalancing"
        echo "âš¡ Tech Stack: Cadence, Flow FCL, Next.js, TypeScript"
        echo "ğŸ“ˆ Leaderboard: https://app.databox.com/datawall/fc5f1f7de13471eac8bd5eb2e3d90a752817ac68a86fd6"
        
    - name: Comment on PR (if PR)
      if: github.event_name == 'pull_request'
      uses: actions/github-script@v7
      with:
        script: |
          github.rest.issues.createComment({
            issue_number: context.issue.number,
            owner: context.repo.owner,
            repo: context.repo.repo,
            body: 'ğŸ† **REWTF Tracker**: Bu PR Fortefication projesine katkÄ± saÄŸlÄ±yor! ğŸš€\n\n' +
                  'ğŸ’¼ **Proje**: Automated DeFi Portfolio Manager\n' +
                  'ğŸŒŠ **Blockchain**: Flow\n' +
                  'âš¡ **Tech**: Cadence + FCL + Next.js\n\n' +
                  '#ReWTF #FlowBlockchain #DeFi #Fortefication'
          })